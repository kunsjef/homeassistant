- alias: 'Home Assistant status'
  trigger:
    - platform: state
      entity_id: input_boolean.test
      from: "off"
      to: "on"
  action:
    - service: script.sonos_say
      data_template:
        sonos_entity: media_player.living_room
        volume: 0.5
#        message: "This is a simple test"
        message: >
          {% if now().strftime("%H")|int < 12 %}
          Good morning.
          {% elif now().strftime("%H")|int < 18 %}
          Good afternoon.
          {% else %}
          Good evening.
          {% endif %}
          # Weather
          It's currently {{states.sensor.dark_sky_summary.state}} and {{states.sensor.outside_temperature.state|round}} degrees in Steinkjer. Today will be {{states.sensor.dark_sky_hourly_summary.state|replace(".", "")}}, with a high of {{states.sensor.dark_sky_daily_high_temperature.state|round}} degrees.
          # Alarm
          {% if is_state('sensor.input_boolean.alarm_home', 'on') %}
          The alarm is turned on. Remember to turn it off before opening any doors.
          {% else %}
          The alarm is off.
          {% endif %}
          # Doors and Windows
          # Washing machine
          {% if is_state('sensor.binary_sensor.washmachine', 'on') %}
          By the way, The washing machine is currently running.
          {% endif %}
          # End
        delay: '00:00:30'
    - delay: 00:00:10
    - service: homeassistant.turn_off
      entity_id: input_boolean.test

